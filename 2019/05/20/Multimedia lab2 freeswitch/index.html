<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="media,">










<meta name="description" content="Multimedia的lab2报告，主要是FreeSWITCH的使用。（再次为删掉了自己lab1的报告而暴哭！）">
<meta name="keywords" content="media">
<meta property="og:type" content="article">
<meta property="og:title" content="Multimedia lab2 freeswitch">
<meta property="og:url" content="https://spartazhc.github.io/2019/05/20/Multimedia lab2 freeswitch/index.html">
<meta property="og:site_name" content="spartazhc&#39;s blog">
<meta property="og:description" content="Multimedia的lab2报告，主要是FreeSWITCH的使用。（再次为删掉了自己lab1的报告而暴哭！）">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Screenshot_2019-05-08-22-09-02-509_org.linphone.png">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Screenshot_2019-05-08-22-00-41-928_org.linphone.png">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Screenshot_2019-05-08-22-03-58-211_org.linphone.png">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/1557729990825.png">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/webRTC.png">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/IMG_20190508_225334.jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/IMG_20190508_225334.jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/IMG_20190508_225122.jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/IMG_20190508_225246.jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/IMG_20190508_225226.jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/IMG_20190508_225407.jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Cache_77f4b204702be80a..jpg">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Screenshot_2019-05-20-12-37-16-743_org.linphone.png">
<meta property="og:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Screenshot_2019-05-20-12-36-17-502_org.linphone.png">
<meta property="og:updated_time" content="2019-05-20T15:57:12.821Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Multimedia lab2 freeswitch">
<meta name="twitter:description" content="Multimedia的lab2报告，主要是FreeSWITCH的使用。（再次为删掉了自己lab1的报告而暴哭！）">
<meta name="twitter:image" content="https://spartazhc.github.io/2019/05/20/Multimedia%20lab2%20freeswitch/Screenshot_2019-05-08-22-09-02-509_org.linphone.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":20,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://spartazhc.github.io/2019/05/20/Multimedia lab2 freeswitch/">





  <title>Multimedia lab2 freeswitch | spartazhc's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">spartazhc's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://spartazhc.github.io/2019/05/20/Multimedia lab2 freeswitch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="spartazhc">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="spartazhc's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Multimedia lab2 freeswitch</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-20T23:31:18+08:00">
                2019-05-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/media/" itemprop="url" rel="index">
                    <span itemprop="name">media</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/05/20/Multimedia lab2 freeswitch/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/05/20/Multimedia lab2 freeswitch/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2019/05/20/Multimedia lab2 freeswitch/" class="leancloud_visitors" data-flag-title="Multimedia lab2 freeswitch">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
      
      

      
        <div class="note default"><p>Multimedia的lab2报告，主要是FreeSWITCH的使用。（再次为删掉了自己lab1的报告而暴哭！）</p></div>

<a id="more"></a>

<div class="note warning"><p>我在本地用的是typora编辑器写markdown，转移到hexo的时候在图片上的显示有点问题，尤其是双栏显示问题很大，有点懒的搞这个。</p></div>

<h2 id="Ubuntu16-04-源码编译安装FreeSWITCH"><a href="#Ubuntu16-04-源码编译安装FreeSWITCH" class="headerlink" title="Ubuntu16.04 源码编译安装FreeSWITCH"></a>Ubuntu16.04 源码编译安装FreeSWITCH</h2><div class="note warning"><p>这部分因为在之前的文章<a href="/2019/05/09/Ubuntu16-04-源码编译安装freeswitch/" title="Ubuntu16-04-源码编译安装freeswitch">Ubuntu16-04-源码编译安装freeswitch</a>已经写了，就略去不表。</p></div>

<h2 id="视频通话实现"><a href="#视频通话实现" class="headerlink" title="视频通话实现"></a>视频通话实现</h2><h3 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h3><p>实现FreeSWITCH支持WebRTC视频通话。</p>
<h3 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h3><p>配置FreeSWITCH，需要启用一些视频会议需要的mod</p>
<h4 id="FreeSWITCH"><a href="#FreeSWITCH" class="headerlink" title="FreeSWITCH"></a>FreeSWITCH</h4><p><strong>FreeSWITCH</strong>是一个免费的开源应用服务器，用于实时通信，WebRTC，电信，视频和互联网协议语音（VoIP）。多平台，它运行在Linux，Windows，macOS和FreeBSD上。它用于构建PBX系统，IVR服务，具有聊天和屏幕共享的视频会议，批发最低成本路由，会话边界控制器（SBC）和嵌入式通讯设备。它完全支持加密，ZRTP，DTLS，SIPS。它可以充当PSTN，SIP，WebRTC和许多其他通信协议之间的网关。它的核心库libFreeSWITCH可以嵌入到其他项目中。它是根据免费软件许可证Mozilla Public License（MPL）许可的。</p>
<p>FreeSWITCH可以处理来自IP网络（VoIP）和PSTN（公共交换电话网络 - 常规固定电话）的语音，视频和文本通信。 FreeSWITCH支持所有流行的VoIP协议以及与PRI的接口。 有关支持的协议的完整列表，请参阅“端点”页面。 FreeSWITCH使用的一些常见功能包括:</p>
<ul>
<li>PBX（办公电话系统）</li>
<li>5类软交换（电话运营商）</li>
<li>应用程序服务器，如语音邮件，会议，IVR</li>
<li>软件电话</li>
</ul>
<h4 id="webRTC"><a href="#webRTC" class="headerlink" title="webRTC"></a>webRTC</h4><p><strong>WebRTC</strong>（Web实时通信）是一个免费的开源项目，通过简单的应用程序编程接口（API）为Web浏览器和移动应用程序提供实时通信（RTC ）。它允许音频和视频通信在网页内部工作，允许直接的点对点通信，无需安装插件或下载本机应用程序。[3]支持苹果，谷歌，微软，Mozilla的，和歌剧，WebRTC正在通过万维网联盟（W3C）和互联网工程任务组（IETF）进行标准化。</p>
<p>其使命是“ 为浏览器，移动平台和物联网设备开发丰富，高质量的RTP应用程序，并允许它们通过一组通用协议进行通信 ”。的参考实现被释放自由软件下一个条款BSD许可证。OpenWebRTC提供了另一种基于多媒体框架GStreamer的免费实现。JavaScript发明家布兰登·艾奇（Brendan Eich）称其为“在一场开放且无阻碍的网络长期战争中的新阵线”。</p>
<h3 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h3><h4 id="配置文件修改"><a href="#配置文件修改" class="headerlink" title="配置文件修改"></a>配置文件修改</h4><p>修改基础配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /usr/local/freeswitch/conf/vars.xml</span></span><br><span class="line"><span class="comment"># 默认密码修改</span></span><br><span class="line">&lt;X-PRE-PROCESS cmd=<span class="string">"set"</span> data=<span class="string">"default_password=666666"</span>/&gt;</span><br><span class="line"><span class="comment"># 修改支持的编码列表</span></span><br><span class="line">&lt;X-PRE-PROCESS cmd=<span class="string">"set"</span> data=<span class="string">"global_codec_prefs=OPUS,G722,PCMU,PCMA,H264,VP8,H263"</span>/&gt;</span><br><span class="line">&lt;X-PRE-PROCESS cmd=<span class="string">"set"</span> data=<span class="string">"outbound_codec_prefs=OPUS,G722,PCMU,PCMA,H264,VP8,H263"</span>/&gt;</span><br><span class="line"><span class="comment"># 打开转码支持</span></span><br><span class="line">&lt;X-PRE-PROCESS cmd=<span class="string">"set"</span> data=<span class="string">"media_mix_inbound_outbound_codecs=true"</span>/&gt;</span><br><span class="line"><span class="comment"># 打开SSL支持</span></span><br><span class="line">&lt;X-PRE-PROCESS cmd=<span class="string">"set"</span> data=<span class="string">"internal_ssl_enable=true"</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>修改sip通话设置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /usr/local/freeswitch/conf/sip_profiles/internal.xml</span></span><br><span class="line"><span class="comment"># 修改</span></span><br><span class="line">&lt;param name=<span class="string">"inbound-late-negotiation"</span> value=<span class="string">"false"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"inbound-zrtp-passthru"</span> value=<span class="string">"false"</span>/&gt;</span><br><span class="line"><span class="comment"># 添加</span></span><br><span class="line">&lt;param name=<span class="string">"apply-candidate-acl"</span> value=<span class="string">"localnet.auto"</span>/&gt;</span><br><span class="line"><span class="comment"># 修改rtp inactivity timeout</span></span><br><span class="line">&lt;param name=<span class="string">"rtp-timeout-sec"</span> value=<span class="string">"30000"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"rtp-hold-timeout-sec"</span> value=<span class="string">"180000"</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>修改默认加载模块：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /usr/local/freeswitch/conf/autoload_configs/modules.conf.xml</span></span><br><span class="line">&lt;load module=<span class="string">"mod_av"</span>/&gt;</span><br><span class="line">&lt;load module=<span class="string">"mod_shout"</span>/&gt;</span><br><span class="line">&lt;load module=<span class="string">"mod_h26x"</span>/&gt;</span><br><span class="line">&lt;load module=<span class="string">"mod_ilbc"</span>/&gt;</span><br><span class="line">&lt;load module=<span class="string">"mod_rtmp"</span>/&gt;</span><br></pre></td></tr></table></figure>

<h4 id="配置修改验证"><a href="#配置修改验证" class="headerlink" title="配置修改验证"></a>配置修改验证</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">freeswitch@xps15&gt; sofia status</span><br><span class="line">                     Name	   Type	                                      Data	State</span><br><span class="line">============================================================================================</span><br><span class="line">external-ipv6	profile	  sip:mod_sofia@[2403:d400:1001:2:cc58:83ee:da6e:b743]:5080	RUNNING (0)</span><br><span class="line">external-ipv6	profile	  sip:mod_sofia@[2403:d400:1001:2:cc58:83ee:da6e:b743]:5081	RUNNING (0) (TLS)</span><br><span class="line">  10.162.48.191	  <span class="built_in">alias</span>	                                  internal	ALIASED</span><br><span class="line">     external	profile	          sip:mod_sofia@10.162.48.191:5080	RUNNING (0)</span><br><span class="line">     external	profile	          sip:mod_sofia@10.162.48.191:5081	RUNNING (0) (TLS)</span><br><span class="line">    external::example.com	gateway	                   sip:joeuser@example.com	NOREG</span><br><span class="line">internal-ipv6	profile	  sip:mod_sofia@[2403:d400:1001:2:cc58:83ee:da6e:b743]:5060	RUNNING (0)</span><br><span class="line">internal-ipv6	profile	  sip:mod_sofia@[2403:d400:1001:2:cc58:83ee:da6e:b743]:5061	RUNNING (0) (TLS)</span><br><span class="line">      internal	profile	          sip:mod_sofia@10.162.48.191:5060	RUNNING (0)</span><br><span class="line">      internal	profile	          sip:mod_sofia@10.162.48.191:5061	RUNNING (0) (TLS)</span><br><span class="line">============================================================================================</span><br><span class="line">4 profiles 1 <span class="built_in">alias</span></span><br></pre></td></tr></table></figure>

<h3 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h3><div class="note dangner"><p>前方高能！</p></div>

<h4 id="两人视频通话"><a href="#两人视频通话" class="headerlink" title="两人视频通话"></a>两人视频通话</h4><p>以下是两人视频通话的实验结果，VP8和H264编码均测试可行。</p>
<p>关于H265， 由于FreeSWITCH不支持H265编解码，因此可以通过开启透传模式进行实验，此时FreeSWITCH不进行编解码，只负责设备间协调。</p>
<p>注意：H265只支持在两个linphone之间拨打，webRTC不支持。</p>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="250" ; src="/2019/05/20/Multimedia lab2 freeswitch/Screenshot_2019-05-08-22-09-02-509_org.linphone.png">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 视频通话效果</div> </center>

<center> 
    <img src="/2019/05/20/Multimedia lab2 freeswitch/Screenshot_2019-05-08-22-00-41-928_org.linphone.png" title="图 H264视频通话" width="250">
    <img src="/2019/05/20/Multimedia lab2 freeswitch/Screenshot_2019-05-08-22-03-58-211_org.linphone.png" title="图 VP8视频通话" width="250"><br>
</center> 




<h4 id="webRTC-1"><a href="#webRTC-1" class="headerlink" title="webRTC"></a>webRTC</h4><p>实验需要使用<a href="https://www.mozilla.org/en-US/firefox/organizations/all/" target="_blank" rel="noopener"><strong>Firefox ESR (Firefox Extended Support Release)</strong></a>浏览器，打开jssip_demo，登录到FreeSWITCH</p>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="450" ; src="/2019/05/20/Multimedia lab2 freeswitch/1557729990825.png">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 webRTC端登录</div> </center>


<p>成功登录之后可以正常进行视频通话、会议通话等，和手机端linphone对等。</p>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="600" ; src="/2019/05/20/Multimedia lab2 freeswitch/webRTC.png">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 webRTC通话效果</div> </center>

<p>此时，可以在FreeSWITCH查看到设备注册情况：</p>
<ul>
<li>手机端 agent：<code>LinphoneAndroid/3.3.1 (belle-sip/1.6.3)</code></li>
<li>电脑端 agent：<code>JsSIP 0.7.17</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">freeswitch@xps15&gt; sofia status profile internal reg</span><br><span class="line">Registrations:</span><br><span class="line">===========================================================================================</span><br><span class="line">Call-ID:    	4TEf3h8-8Q</span><br><span class="line">User:       	1000@10.162.48.191</span><br><span class="line">Contact:    	<span class="string">""</span> &lt;sip:1000@10.162.158.184:37914;transport=udp&gt;</span><br><span class="line">Agent:      	LinphoneAndroid/3.3.1 (belle-sip/1.6.3)</span><br><span class="line">Status:     	Registered(UDP)(unknown) EXP(2019-05-13 15:40:51) EXPSECS(3128)</span><br><span class="line">Ping-Status:	Reachable</span><br><span class="line">Ping-Time:	0.00</span><br><span class="line">Host:       	xps15</span><br><span class="line">IP:         	10.162.158.184</span><br><span class="line">Port:       	37914</span><br><span class="line">Auth-User:  	1000</span><br><span class="line">Auth-Realm: 	10.162.48.191</span><br><span class="line">MWI-Account:	1000@10.162.48.191</span><br><span class="line"></span><br><span class="line">Call-ID:    	e7pjfnevajs4jt4tdc58dk</span><br><span class="line">User:       	1001@10.162.48.191</span><br><span class="line">Contact:    	<span class="string">""</span> &lt;sip:hmf3085e@75k2o7pe5ngo.invalid;transport=ws;fs_nat=yes;fs_path=sip%3Ahmf3085e%4010.162.48.191%3A56540%3Btransport%3Dws&gt;</span><br><span class="line">Agent:      	JsSIP 0.7.17</span><br><span class="line">Status:     	Registered(WS-NAT)(unknown) EXP(2019-05-13 14:58:45) EXPSECS(602)</span><br><span class="line">Ping-Status:	Reachable</span><br><span class="line">Ping-Time:	0.00</span><br><span class="line">Host:       	xps15</span><br><span class="line">IP:         	10.162.48.191</span><br><span class="line">Port:       	56540</span><br><span class="line">Auth-User:  	1001</span><br><span class="line">Auth-Realm: 	10.162.48.191</span><br><span class="line">MWI-Account:	1001@10.162.48.191</span><br><span class="line"></span><br><span class="line">Total items returned: 2</span><br><span class="line">===========================================================================================</span><br></pre></td></tr></table></figure>

<h4 id="视频会议"><a href="#视频会议" class="headerlink" title="视频会议"></a>视频会议</h4><p>拨号3000可以进入视频会议：</p>
<p>通过<code>conference + commend</code>可以手动对视频会议配置进行修改。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">freeswitch@xps15&gt; conference  list</span><br><span class="line">Conference 3000-10.162.48.191 (2 members rate: 8000 flags: running|answered|enforce_min|dynamic|exit_sound|enter_sound|video_floor_only|video_rfc4579|livearray_sync|transcode_video|video_muxing|minimize_video_encoding|json_status)</span><br><span class="line">2;sofia/internal/1001@10.162.48.191;724374d7-55b5-4998-ba53-2fc160ff9650;1001;1001;hear|speak|video;0;0;0;100</span><br><span class="line">1;sofia/internal/1000@10.162.48.191;32797f63-e4c4-489f-b2fc-aa2ac91fdff9;1000;1000;hear|speak|talking|video|floor|vid-floor;0;0;0;100</span><br></pre></td></tr></table></figure>

<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="600" ; src="/2019/05/20/Multimedia lab2 freeswitch/IMG_20190508_225334.jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 视频会议效果</div> </center>

<h5 id="视频会议布局修改"><a href="#视频会议布局修改" class="headerlink" title="视频会议布局修改"></a>视频会议布局修改</h5><p>调整视频会议布局需要修改以下配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /usr/local/freeswitch/conf/autoload_configs/conference.conf.xml</span></span><br><span class="line"><span class="comment"># 加载布局模块</span></span><br><span class="line">&lt;param name=<span class="string">"conference-flags"</span> value=<span class="string">"video-floor-only|rfc-4579|livearray-sync|minimize-video-encoding"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"video-mode"</span> value=<span class="string">"mux"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"video-layout-name"</span> value=<span class="string">"2x2"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"video-canvas-size"</span> value=<span class="string">"1920x1080"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"video-canvas-bgcolor"</span> value=<span class="string">"#333333"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"video-layout-bgcolor"</span> value=<span class="string">"#000000"</span>/&gt;</span><br><span class="line">&lt;param name=<span class="string">"video-fps"</span> value=<span class="string">"25"</span>/&gt;</span><br></pre></td></tr></table></figure>

<p>在<code>conference_layouts.conf.xml</code>中，FreeSWITCH预置了一些布局配置：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groups</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">group</span> <span class="attr">name</span>=<span class="string">"grid"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>1x1<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>2x1<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>1x1+2x1<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>2x2<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>3x3<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>4x4<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>5x5<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>6x6<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>8x8<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">group</span> <span class="attr">name</span>=<span class="string">"grid-zoom"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>1x1<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>2x1-zoom<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>3x1-zoom<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>2x2<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>5-grid-zoom<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>3x2-zoom<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>7-grid-zoom<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>4x2-zoom<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>3x3<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">group</span> <span class="attr">name</span>=<span class="string">"1up_top_left_plus"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>1up_top_left+5<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>1up_top_left+7<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>1up_top_left+9<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">group</span> <span class="attr">name</span>=<span class="string">"3up_plus"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>3up+4<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">layout</span>&gt;</span>3up+9<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">groups</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="布局调整测试"><a href="#布局调整测试" class="headerlink" title="布局调整测试"></a>布局调整测试</h5><p>在FreeSWITCH中使用命令：<code>conference 3000-10.162.48.191 vid-layout 1up_top_left+5</code>，可以实时修改布局配置，其中，可修改的布局在前文已经展示，以下展示了一些布局效果。</p>
<ul>
<li>1x1+2x1</li>
</ul>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="500" ; src="/2019/05/20/Multimedia lab2 freeswitch/IMG_20190508_225334.jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 布局1x1+2x1</div> </center>

<ul>
<li>2x2</li>
</ul>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="500" ; src="/2019/05/20/Multimedia lab2 freeswitch/IMG_20190508_225122.jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 布局2x2</div> </center>

<ul>
<li>3x1-zoom</li>
</ul>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="500" ; src="/2019/05/20/Multimedia lab2 freeswitch/IMG_20190508_225246.jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 布局3x1-zoom</div> </center>

<ul>
<li>1up_top_left_plus</li>
</ul>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="500" ; src="/2019/05/20/Multimedia lab2 freeswitch/IMG_20190508_225226.jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 布局1up_top_left_plus</div> </center>

<ul>
<li>3up+4</li>
</ul>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="500" ; src="/2019/05/20/Multimedia lab2 freeswitch/IMG_20190508_225407.jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">图 布局3up+4</div> </center>

<h4 id="延迟测试"><a href="#延迟测试" class="headerlink" title="延迟测试"></a>延迟测试</h4><p>以下是延迟测试，可以看到通过视频通话实时传回的图像中，时钟显示在同一秒，说明延迟在1s以内。</p>
<center>     <img style="border-radius: 0.3125em;     box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" width="500" ; src="/2019/05/20/Multimedia lab2 freeswitch/Cache_77f4b204702be80a..jpg">     <br>     <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 0px;">图 延迟测试</div> </center>

<h4 id="H264-vs-H265"><a href="#H264-vs-H265" class="headerlink" title="H264 vs H265"></a>H264 vs H265</h4><p>我们在保持通话双方摄像头固定、画面保持不变的情况下分别测试了H264和H65视频通话，从以下结果可以看到，H265的编码效率略高于H264。</p>
<ul>
<li>由于视频通话时，上传下载带宽是不断变化的，截图只能反映大致信息不能完全代表两者差异</li>
<li>事实上感觉H265只比H264好了一点点，差距不是太大，这可能和视频分辨率较小也有关。</li>
</ul>
<center> 
    <img src="/2019/05/20/Multimedia lab2 freeswitch/Screenshot_2019-05-20-12-37-16-743_org.linphone.png" title="图 H265视频通话" width="250">
    <img src="/2019/05/20/Multimedia lab2 freeswitch/Screenshot_2019-05-20-12-36-17-502_org.linphone.png" title="图 H264视频通话" width="250"><br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;">               </div>   <div style="color:orange; border-bottom: 1px solid #d9d9d9;     display: inline-block;     color: #999;     padding: 2px;"></div> 
</center> 


<h3 id="分析总结"><a href="#分析总结" class="headerlink" title="分析总结"></a>分析总结</h3><p>本次实验总体来说难度不大，主要困难在于FreeSWITCH编译时碰到的问题，由于FreeSWITCH的使用仅限于视频通话的设置和视频会议的设置，在ppt较为完善的内容知指导以及学长的热心答疑下，后续部分难度不大。</p>
<h3 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h3><h4 id="不能修改视频会议布局"><a href="#不能修改视频会议布局" class="headerlink" title="不能修改视频会议布局"></a>不能修改视频会议布局</h4><p>原因是重新编译安装了FreeSWITCH后，忘记修改<code>conference.conf.xml</code>文件了，相当于没有加载布局模块</p>
<h4 id="视频会议选择H265没有视频"><a href="#视频会议选择H265没有视频" class="headerlink" title="视频会议选择H265没有视频"></a>视频会议选择H265没有视频</h4><p>原因是FreeSWITCH默认没有支持。</p>
<h3 id="号码说明"><a href="#号码说明" class="headerlink" title="号码说明"></a>号码说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">9999 | 保持音乐</span><br><span class="line">9996 | echo，回音测试 </span><br><span class="line">9992 | info，在控制台上显示呼叫参数</span><br><span class="line">9888 | FreeSWITCH电话会议，每周召开</span><br><span class="line">5900 | 呼叫挂起</span><br><span class="line">5901 | 接听挂起的呼叫</span><br><span class="line">5000 | 示例IVR</span><br><span class="line">4000 | 听取语音信箱</span><br><span class="line">33xx | 电话会议，48K(其中xx可为00-99，下同)</span><br><span class="line">32xx | 电话会议，32K</span><br><span class="line">31xx | 电话会议，16K</span><br><span class="line">30xx | 电话会议，8K</span><br><span class="line">2000-2002 | 呼叫组</span><br><span class="line">1000-1019 | 默认分机号</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://blog.csdn.net/Reasonss/article/details/81171288" target="_blank" rel="noopener">Ubuntu16.04从零开始freeSWITCH安装</a></li>
<li><a href="https://wsonh.com/article/22.html" target="_blank" rel="noopener">在ubuntu16.04部署配置安装freeswitch以及常见问题解决</a></li>
<li><a href="https://www.codetd.com/article/5754468" target="_blank" rel="noopener">Ubuntu 16.04 install FreeSWITCH v1.8</a></li>
<li><a href="https://blog.csdn.net/u011745859/article/details/82150814" target="_blank" rel="noopener">FreeSwitch 1.9.0支持H264的视频会议配置</a></li>
<li><a href="https://blog.csdn.net/Java_lilin/article/details/78121184" target="_blank" rel="noopener">ubuntu16.04 编译freeswitch1.9的视频mod_av模块</a></li>
</ul>
<hr>

      
        <div>
          
            <div>
    
        <div style="text-align:center;color: #636363;font-size:14px;letter-spacing: 10px">本文结束啦<i class="fa fa-bell"></i>感谢您的阅读</div>
    
</div>

          
        </div>
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/media/" rel="tag"> <i class="fa fa-tag"> </i> media</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/20/Ubuntu16-04-通过apt安装vapoursynth/" rel="next" title="Ubuntu16.04 通过apt安装vapoursynth">
                <i class="fa fa-chevron-left"></i> Ubuntu16.04 通过apt安装vapoursynth
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="spartazhc">
            
              <p class="site-author-name" itemprop="name">spartazhc</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/spartazhc" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://douban.com/people/130051643" target="_blank" title="豆瓣">
                      
                        <i class="fa fa-fw fa-bug"></i>豆瓣</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Ubuntu16-04-源码编译安装FreeSWITCH"><span class="nav-number">1.</span> <span class="nav-text">Ubuntu16.04 源码编译安装FreeSWITCH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#视频通话实现"><span class="nav-number">2.</span> <span class="nav-text">视频通话实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#实验目的"><span class="nav-number">2.1.</span> <span class="nav-text">实验目的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实验原理"><span class="nav-number">2.2.</span> <span class="nav-text">实验原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FreeSWITCH"><span class="nav-number">2.2.1.</span> <span class="nav-text">FreeSWITCH</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webRTC"><span class="nav-number">2.2.2.</span> <span class="nav-text">webRTC</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实验过程"><span class="nav-number">2.3.</span> <span class="nav-text">实验过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置文件修改"><span class="nav-number">2.3.1.</span> <span class="nav-text">配置文件修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置修改验证"><span class="nav-number">2.3.2.</span> <span class="nav-text">配置修改验证</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实验结果"><span class="nav-number">2.4.</span> <span class="nav-text">实验结果</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#两人视频通话"><span class="nav-number">2.4.1.</span> <span class="nav-text">两人视频通话</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#webRTC-1"><span class="nav-number">2.4.2.</span> <span class="nav-text">webRTC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#视频会议"><span class="nav-number">2.4.3.</span> <span class="nav-text">视频会议</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#视频会议布局修改"><span class="nav-number">2.4.3.1.</span> <span class="nav-text">视频会议布局修改</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#布局调整测试"><span class="nav-number">2.4.3.2.</span> <span class="nav-text">布局调整测试</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#延迟测试"><span class="nav-number">2.4.4.</span> <span class="nav-text">延迟测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#H264-vs-H265"><span class="nav-number">2.4.5.</span> <span class="nav-text">H264 vs H265</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分析总结"><span class="nav-number">2.5.</span> <span class="nav-text">分析总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#问题解决"><span class="nav-number">2.6.</span> <span class="nav-text">问题解决</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#不能修改视频会议布局"><span class="nav-number">2.6.1.</span> <span class="nav-text">不能修改视频会议布局</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#视频会议选择H265没有视频"><span class="nav-number">2.6.2.</span> <span class="nav-text">视频会议选择H265没有视频</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#号码说明"><span class="nav-number">2.7.</span> <span class="nav-text">号码说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">3.</span> <span class="nav-text">参考</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">spartazhc</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>
  <span>　<i class="fa fa-clock"></i></span>
  <span id="showDays"></span>




<script>
  var seconds = 1000;
  var minutes = seconds * 60;
  var hours = minutes * 60;
  var days = hours * 24;
  var years = days * 365;
  var birthDay = Date.UTC(2019,04,29,00,00,00); // 这里设置建站时间
  setInterval(function() {
    var today = new Date();
    var todayYear = today.getFullYear();
    var todayMonth = today.getMonth()+1;
    var todayDate = today.getDate();
    var todayHour = today.getHours();
    var todayMinute = today.getMinutes();
    var todaySecond = today.getSeconds();
    var now = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
    var diff = now - birthDay;
    var diffYears = Math.floor(diff/years);
    var diffDays = Math.floor((diff/days)-diffYears*365);
    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      document.getElementById('showDays').innerHTML="本站已运行 "+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
  }, 1000);
</script>

        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'CyVb5GcDokobJWn5jYs0YPHx-gzGzoHsz',
        appKey: 'BPpypYK7M7mcSQVUjgoAcQDs',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("CyVb5GcDokobJWn5jYs0YPHx-gzGzoHsz", "BPpypYK7M7mcSQVUjgoAcQDs");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
